"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_events=require("events"),_events2=_interopRequireDefault(_events),_react=require("react"),_react2=_interopRequireDefault(_react),_Enigma=require("enigma-minkiele/dist/Enigma"),_Enigma2=_interopRequireDefault(_Enigma),_EnigmaM=require("enigma-minkiele/dist/EnigmaM4"),_EnigmaM2=_interopRequireDefault(_EnigmaM),_RotorI=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/RotorI"),_RotorI2=_interopRequireDefault(_RotorI),_RotorII=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/RotorII"),_RotorII2=_interopRequireDefault(_RotorII),_RotorIII=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/RotorIII"),_RotorIII2=_interopRequireDefault(_RotorIII),_RotorIV=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/RotorIV"),_RotorIV2=_interopRequireDefault(_RotorIV),_RotorV=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/RotorV"),_RotorV2=_interopRequireDefault(_RotorV),_RotorVI=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/RotorVI"),_RotorVI2=_interopRequireDefault(_RotorVI),_RotorVII=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/RotorVII"),_RotorVII2=_interopRequireDefault(_RotorVII),_RotorVIII=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/RotorVIII"),_RotorVIII2=_interopRequireDefault(_RotorVIII),_ThinRotorBeta=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/ThinRotor/ThinRotorBeta"),_ThinRotorBeta2=_interopRequireDefault(_ThinRotorBeta),_ThinRotorGamma=require("enigma-minkiele/dist/Component/WiredWheel/Rotor/ThinRotor/ThinRotorGamma"),_ThinRotorGamma2=_interopRequireDefault(_ThinRotorGamma),_ReflectorA=require("enigma-minkiele/dist/Component/WiredWheel/Reflector/ReflectorA"),_ReflectorA2=_interopRequireDefault(_ReflectorA),_ReflectorB=require("enigma-minkiele/dist/Component/WiredWheel/Reflector/ReflectorB"),_ReflectorB2=_interopRequireDefault(_ReflectorB),_ReflectorC=require("enigma-minkiele/dist/Component/WiredWheel/Reflector/ReflectorC"),_ReflectorC2=_interopRequireDefault(_ReflectorC),_ReflectorBeta=require("enigma-minkiele/dist/Component/WiredWheel/Reflector/ReflectorBeta"),_ReflectorBeta2=_interopRequireDefault(_ReflectorBeta),_ReflectorGamma=require("enigma-minkiele/dist/Component/WiredWheel/Reflector/ReflectorGamma"),_ReflectorGamma2=_interopRequireDefault(_ReflectorGamma),_ThinReflectorB=require("enigma-minkiele/dist/Component/WiredWheel/Reflector/ThinReflector/ThinReflectorB"),_ThinReflectorB2=_interopRequireDefault(_ThinReflectorB),_ThinReflectorC=require("enigma-minkiele/dist/Component/WiredWheel/Reflector/ThinReflector/ThinReflectorC"),_ThinReflectorC2=_interopRequireDefault(_ThinReflectorC),_Constants=require("./Constants"),Const=_interopRequireWildcard(_Constants),_Enigma3=require("./UI/Enigma"),_Enigma4=_interopRequireDefault(_Enigma3),_Utils=require("./Utils"),Enigma=function(){function e(t){var o=this;_classCallCheck(this,e),this.renderingEngine=t,this.eventManager=new _events2.default,this.setType(Const.DEFAULT_TYPE),this.setLastEncodedLetter(""),this.render(),this.eventManager.on("change.type",function(e){o.setType(e),o.render()}),this.eventManager.on("change.reflector",function(e){o.setReflector(e),o.render()}),this.eventManager.on("change.rotor.type",function(e,t){o.setRotor(e,t),o.render()}),this.eventManager.on("change.rotor.windowLetter",function(e,t){o.setRotorWindowLetter(e,t),o.render()}),this.eventManager.on("change.rotor.ringPosition",function(e,t){o.setRotorRingPosition(e,t),o.render()}),this.eventManager.on("change.plugBoard.removeWiring",function(e){try{o.enigma.plugBoard.unplugWire(e[0],e[1]),o.render()}catch(e){}}),this.eventManager.on("change.plugBoard.addWiring",function(e){try{o.enigma.plugBoard.plugWire(e[0],e[1]),o.render()}catch(e){}}),this.eventManager.on("change.keyboard.input",function(e){try{o.setLastEncodedLetter(o.enigma.getEncodedLetter(e)),o.render()}catch(e){}})}return _createClass(e,[{key:"setType",value:function(e){switch(e){case Const.TYPE_M3:this.enigma=new _Enigma2.default;break;case Const.TYPE_M4:this.enigma=new _EnigmaM2.default}}},{key:"getType",value:function(){return this.enigma instanceof _EnigmaM2.default?Const.TYPE_M4:this.enigma instanceof _Enigma2.default?Const.TYPE_M3:void 0}},{key:"setReflector",value:function(e){var t=void 0;switch(e){case Const.RE_TYPE_A:t=new _ReflectorA2.default;break;case Const.RE_TYPE_B:t=new _ReflectorB2.default;break;case Const.RE_TYPE_C:t=new _ReflectorC2.default;break;case Const.RE_TYPE_BETA:t=new _ReflectorBeta2.default;break;case Const.RE_TYPE_GAMMA:t=new _ReflectorGamma2.default;break;case Const.RE_TYPE_THIN_B:t=new _ThinReflectorB2.default;break;case Const.RE_TYPE_THIN_C:t=new _ThinReflectorC2.default}this.enigma.setReflector(t)}},{key:"getReflectorType",value:function(){var e=this.enigma.reflector;return e instanceof _ReflectorA2.default?Const.RE_TYPE_A:e instanceof _ReflectorB2.default?Const.RE_TYPE_B:e instanceof _ReflectorC2.default?Const.RE_TYPE_C:e instanceof _ReflectorBeta2.default?Const.RE_TYPE_BETA:e instanceof _ReflectorGamma2.default?Const.RE_TYPE_GAMMA:e instanceof _ThinReflectorB2.default?Const.RE_TYPE_THIN_B:e instanceof _ThinReflectorC2.default?Const.RE_TYPE_THIN_C:void 0}},{key:"setRotor",value:function(e,t){var o=void 0;switch(e){case Const.RO_TYPE_I:o=new _RotorI2.default;break;case Const.RO_TYPE_II:o=new _RotorII2.default;break;case Const.RO_TYPE_III:o=new _RotorIII2.default;break;case Const.RO_TYPE_IV:o=new _RotorIV2.default;break;case Const.RO_TYPE_V:o=new _RotorV2.default;break;case Const.RO_TYPE_VI:o=new _RotorVI2.default;break;case Const.RO_TYPE_VII:o=new _RotorVII2.default;break;case Const.RO_TYPE_VII:o=new _RotorVII2.default;break;case Const.RO_TYPE_VIII:o=new _RotorVIII2.default;break;case Const.RO_TYPE_THIN_BETA:o=new _ThinRotorBeta2.default;break;case Const.RO_TYPE_THIN_GAMMA:o=new _ThinRotorGamma2.default}this.enigma.setRotor(o,t)}},{key:"getRotorType",value:function(e){var t=this.enigma.getRotor(e);return t instanceof _RotorI2.default?Const.RO_TYPE_I:t instanceof _RotorII2.default?Const.RO_TYPE_II:t instanceof _RotorIII2.default?Const.RO_TYPE_III:t instanceof _RotorIV2.default?Const.RO_TYPE_IV:t instanceof _RotorV2.default?Const.RO_TYPE_V:t instanceof _RotorVI2.default?Const.RO_TYPE_VI:t instanceof _RotorVII2.default?Const.RO_TYPE_VII:t instanceof _RotorVIII2.default?Const.RO_TYPE_VIII:t instanceof _ThinRotorBeta2.default?Const.RO_TYPE_THIN_BETA:t instanceof _ThinRotorGamma2.default?Const.RO_TYPE_THIN_GAMMA:void 0}},{key:"getRotorProps",value:function(e){var t={},o=this.getRotorType(e);if("undefined"!=typeof o){this.enigma.getRotor(e);t.type=o,t.windowLetter=this.enigma.getRotorWindowLetter(e),t.ringPosition=this.enigma.getRotor(e).ringPosition}return t}},{key:"setRotorWindowLetter",value:function(e,t){this.enigma.setRotorWindowLetter(e,t)}},{key:"setRotorRingPosition",value:function(e,t){var o=this.enigma.getRotor(t);"undefined"!=typeof o&&o.setRingPosition(e)}},{key:"getPlugBoardWirings",value:function(){var e=this.enigma.plugBoard.wirings.slice();return e}},{key:"setLastEncodedLetter",value:function(e){this.lastEncodedLetter=e}},{key:"getLastEncodedLetter",value:function(){var e=this.lastEncodedLetter;return e}},{key:"getRenderingEngine",value:function(){throw"App must override this method"}},{key:"render",value:function(){this.renderingEngine.render(_react2.default.createElement(_Enigma4.default,{type:this.getType(),reflector:this.getReflectorType(),fourthRotor:this.getRotorProps(Const.FOURTH_ROTOR),leftRotor:this.getRotorProps(Const.LEFT_ROTOR),centerRotor:this.getRotorProps(Const.CENTER_ROTOR),rightRotor:this.getRotorProps(Const.RIGHT_ROTOR),plugBoardWirings:this.getPlugBoardWirings(),lastEncodedLetter:this.getLastEncodedLetter(),eventManager:this.eventManager}))}}]),e}();exports.default=Enigma,module.exports=exports.default;